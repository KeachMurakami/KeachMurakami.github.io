---
title: "換気回数"
output: html_document
layout: post
tags: lab photosynthesis
---


```{r setup, eval = TRUE, echo = FALSE, message= F}
require(ggplot2)
require(plyr)
require(dplyr)
require(knitr)
require(magrittr)
require(devtools)
require(tidyr)
require(RCurl)
require(stringr)
OFFline <- class(try(source_url(url = "https://raw.githubusercontent.com/KeachMurakami/Sources/master/NetworkTest.txt"), silent = T)) == "try-error"
MyFunctions <-
  getURL("https://raw.githubusercontent.com/KeachMurakami/Sources/master/functions.txt") %>%
  str_split(pattern = "\n") %>%
  .[[1]] %>%
  {.[!str_detect(., pattern = "Startup")]} %>%
  paste0("https://raw.githubusercontent.com/KeachMurakami/Sources/master/", .)
MyFunctions[!str_detect(MyFunctions, pattern = "Startup")] %>%
  a_ply(., .fun = source_url, .margins = 1)
```


光合成速度測定は、サンプル室内への流入CO~2~濃度サンプル室内からの流出CO~2~濃度の差から計算される  
このとき、サンプル室の容積 (*V*; mol (空気体積換算)) が大きく、換気量 (*Q*; mol s^--1^) が小さい条件では、サンプル室内の換気に時間を要するため、十分時間待たないと正しく光合成速度を評価できない  
具体的には

- 流路切替により、1台のCO~2~濃度測器により流入出ガス濃度を測定する場合  
- 測定条件を変化させた直後の光合成速度の経時的な推移を評価する場合  

などの場合には注意が必要になる


### 理論

換気回数 (gas exchange rate; *N* = *Q*/*V*) を指標として、ガス交換の待機時間を設定する  

- 葉の純光合成速度を*P*~n~ µmol s^--1^
- 流入ガス中のCO~2~濃度を*C*~in~ µmol mol^--1^
- 流出ガス中のCO~2~濃度 = サンプル室内のCO~2~濃度を *C*~out~ µmol mol^--1^

とすると、サンプル室内CO~2~物質量の増加 (*VdC*~out~) は、

$$
  VdC_{\rm {out}} = -P_{\rm {n}}dt + (C_{\rm {in}} - C_{\rm {out}})Qdt
$$

と表される

- 流路切替・条件変更時点をt = 0
- *C*~out,t=0~ = *C*~init~
- *P*~n,t>0~ = *P*~n~ + Δ*P*~n~

とすると、*C*~out,t~は、

$$
  C_{\rm {out,t}} = C_{init} - \frac{\Delta P_{\rm {n}}}{Q}(e^{-Nt} - 1)
$$

となる


### 実際

LI6400XTが光合成速度測定の標準として使われる  

- LI6400XTのサンプル室内容積は56.4 cm^3^  
- 室内へのガス流量は100--700 µmol s^--1^ で可変  
- チャンバに挟む葉面積は6 cm^2^ 

流路切替・条件変更による光合成速度変化量を1.0 µmol m^--2^ s^--1^ とすると、
Δ*P*~n~ = 6 * 10^-4^ µmol s^--1^ 

```{r GasExchangeDelay}
ChamberVolume <- 56.4 # cm3
FlowRate <- 500 # µmol s-1
deltaPn <- 6.0 * 10^-4 # µmol s-1

N_exchange <-
  function(flow = FlowRate, vol = ChamberVolume){
    vol_L <- vol * 0.001
    flow_L_s <- flow * 22.4 * 10^(-6)
    (flow_L_s / vol_L) %>%
      return
  }

delta_decay <-
  function(flow = FlowRate, vol = ChamberVolume){
  data_frame(
    Time = seq(0, 100, 1),
    Conc. = deltaPn * (exp(- N_exchange(flow = flow, vol = vol) * Time) - 1) * 10^6 / flow
    )
  }

Fig_Gas <-
  lapply(seq(100, 700, 200), function(flow){
    delta_decay(flow, vol = ChamberVolume) %>%
      mutate(Flow = paste("  flow rate:", flow))
  }) %>%
    rbind_all %>%
    ggplot(aes(x = Time, y = Conc., group = Flow, col = Flow)) +
    geom_line() +
    geom_point(alpha = .75) +
    xlab("Time [s]") +
    ylab(u_CO2("Conc.sample - Conc.ref", type = "")) +
    gg_x(c(-1, 121)) + 
    guides(col = F)

directlabels::direct.label(Fig_Gas, "last.points")

```


### つらつらと

デフォルトの流量 500 µmol s^--1^では、30 s 程度で十分に安定する  
S/N比を高める目的で流量を落としてもいいかもしれない  
ただ、その場合はサンプル室内の飽差が低下 (相対湿度が上昇) し、結露が起こりやすくなる  


### 参考ページ  
[植物組織培養器内環境の基礎的研究 (3) 培養小植物体を含む閉栓容器内の炭酸ガス濃度測定と培養小植物体の純光合成速度の推定](https://www.jstage.jst.go.jp/article/agrmet1943/43/1/43_1_21/_article/-char/ja/)

```{r info}
devtools::session_info()
```